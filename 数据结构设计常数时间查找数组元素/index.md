# ã€æ•°æ®ç»“æ„è®¾è®¡ã€‘å¸¸æ•°æ—¶é—´æŸ¥æ‰¾æ•°ç»„å…ƒç´ 


## 1 é¢˜ç›®

**åŠ›æ‰£ [146. LRU ç¼“å­˜](https://leetcode.cn/problems/lru-cache/)**

è¯·ä½ è®¾è®¡å¹¶å®ç°ä¸€ä¸ªæ»¡è¶³ [LRU (æœ€è¿‘æœ€å°‘ä½¿ç”¨) ç¼“å­˜](https://baike.baidu.com/item/LRU) çº¦æŸçš„æ•°æ®ç»“æ„ã€‚

å®ç° `LRUCache` ç±»ï¼š

- `LRUCache(int capacity)` ä»¥ **æ­£æ•´æ•°** ä½œä¸ºå®¹é‡ `capacity` åˆå§‹åŒ– LRU ç¼“å­˜
- `int get(int key)` å¦‚æœå…³é”®å­— `key` å­˜åœ¨äºç¼“å­˜ä¸­ï¼Œåˆ™è¿”å›å…³é”®å­—çš„å€¼ï¼Œå¦åˆ™è¿”å› `-1` ã€‚
- `void put(int key, int value)` å¦‚æœå…³é”®å­— `key` å·²ç»å­˜åœ¨ï¼Œåˆ™å˜æ›´å…¶æ•°æ®å€¼ `value` ï¼›å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å‘ç¼“å­˜ä¸­æ’å…¥è¯¥ç»„ `key-value` ã€‚å¦‚æœæ’å…¥æ“ä½œå¯¼è‡´å…³é”®å­—æ•°é‡è¶…è¿‡ `capacity` ï¼Œåˆ™åº”è¯¥ **é€å‡º** æœ€ä¹…æœªä½¿ç”¨çš„å…³é”®å­—ã€‚

å‡½æ•° `get` å’Œ `put` å¿…é¡»ä»¥ `O(1)` çš„å¹³å‡æ—¶é—´å¤æ‚åº¦è¿è¡Œã€‚

## 2 è§£æ

### 2.1 LRUç®—æ³•è®¾è®¡

ç”±äº put å’Œ get æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡º cache è¿™ä¸ªæ•°æ®ç»“æ„å¿…è¦çš„æ¡ä»¶ï¼š  

> ğŸ”´ cache ä¸­çš„å…ƒç´ å¿…é¡»æœ‰æ—¶åºï¼Œä»¥åŒºåˆ†æœ€è¿‘ä½¿ç”¨çš„å’Œä¹…æœªä½¿ç”¨çš„æ•°æ®  
>
> ğŸŸ¡ èƒ½åœ¨ cache ä¸­å¿«é€Ÿæ‰¾æŸä¸ª key æ˜¯å¦å·²å­˜åœ¨å¹¶å¾—åˆ°å¯¹åº”çš„ val  
>
> ğŸŸ¢ cache è¦æ”¯æŒåœ¨ä»»æ„ä½ç½®å¿«é€Ÿæ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œä¾¿äºè®¿é—®æŸä¸ª key å¹¶å°†è¿™ä¸ªå…ƒç´ å˜ä¸ºæœ€è¿‘ä½¿ç”¨çš„

å“ˆå¸Œè¡¨æŸ¥æ‰¾å¿«ï¼Œä½†æ˜¯æ•°æ®æ— å›ºå®šé¡ºåºï¼›é“¾è¡¨æœ‰é¡ºåºä¹‹åˆ†ï¼Œæ’å…¥åˆ é™¤å¿«ï¼Œä½†æ˜¯æŸ¥æ‰¾æ…¢ã€‚æ‰€ä»¥ç»“åˆä¸€ä¸‹ï¼Œå½¢æˆä¸€ç§æ–°çš„æ•°æ®ç»“æ„ï¼š**å“ˆå¸Œé“¾è¡¨ LinkedHashMap**ã€‚  

LRU ç¼“å­˜ç®—æ³•çš„æ ¸å¿ƒæ•°æ®ç»“æ„å°±æ˜¯**å“ˆå¸Œé“¾è¡¨**ï¼Œ**åŒå‘é“¾è¡¨å’Œå“ˆå¸Œè¡¨çš„ç»“åˆä½“**ã€‚ å¦‚å›¾æ‰€ç¤ºï¼š

![img1](/img/labuladong/6-1.png)

æ ¹æ®è¿™ä¸ªç»“æ„åˆ†æä»¥ä¸Š 3 ä¸ªæ¡ä»¶ï¼š

> ğŸŸ¥ æ¯æ¬¡ä»é“¾è¡¨å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼Œåˆ™å°¾éƒ¨å°±æ˜¯æœ€è¿‘ä½¿ç”¨çš„ï¼Œå¤´éƒ¨å°±æ˜¯æœ€ä¹…æœªä½¿ç”¨çš„
>
> ğŸŸ¨ é€šè¿‡å“ˆå¸Œè¡¨å¯ä»¥æ ¹æ® key å¿«é€Ÿè·å¾— val
>
> ğŸŸ© ç”¨å“ˆå¸Œè¡¨å°† key å¿«é€Ÿæ˜ å°„åˆ°é“¾è¡¨èŠ‚ç‚¹åï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œæ’å…¥ã€åˆ é™¤æ“ä½œ

ä¸¤ä¸ªé—®é¢˜ï¼š

> â“ ç”¨å•é“¾è¡¨å–ä»£åŒé“¾è¡¨è¡Œä¸è¡Œï¼Ÿ
>
> â“ å“ˆå¸Œè¡¨ä¸­å­˜äº† keyï¼Œé“¾è¡¨ä¸­ä¸ºä»€ä¹ˆè¿˜è¦å­˜ key å’Œ valï¼Ÿå¯ä»¥åªå­˜ val å—ï¼Ÿ



### 2.2 ä»£ç å®ç°

é¦–å…ˆå†™å‡ºåŒé“¾è¡¨èŠ‚ç‚¹ç±»å‹ Nodeï¼š

```java
class RandomizedSet {
public:
    vector<int> ve;
    unordered_map<int, int> ma; // é”®æ˜¯å…ƒç´ å€¼ï¼Œå€¼æ˜¯å…ƒç´ åœ¨veä¸­çš„ç´¢å¼•
    RandomizedSet() {

    }
    
    bool insert(int val) {
        if(ma.find(val) == ma.end()){   // æ³¨æ„æ¡ä»¶ï¼åˆ«å†™åäº†
            ma[val]=ve.size();  // æ³¨æ„æ·»åŠ é”®å€¼å¯¹çš„å†™æ³•
            ve.push_back(val);
            return true;
        }
        return false;
    }
    
    bool remove(int val) {
        if(ma.find(val) != ma.end()){
            ma[ve.back()]=ma[val];  // æ›´æ–° ma ä¸­çš„ç´¢å¼•
            swap(ve[ma[val]],ve.back());    // æ›´æ–°veä¸­çš„ä¸¤ä¸ªå…ƒç´ 
            ve.pop_back();  // åˆ é™¤veä¸­çš„å…ƒç´ 
            ma.erase(val);  // åˆ é™¤maä¸­çš„å…ƒç´ 
            return true;
        }
        return false;
    }
    
    int getRandom() {
        return ve[rand() % ve.size()];
    }
};
```


